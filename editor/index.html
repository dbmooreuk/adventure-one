<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Data Editor - Adventure Game</title>
    <link rel="stylesheet" href="css/editor.css">
</head>
<body>
    <div class="editor-container">
        <!-- Header -->
        <header class="editor-header">
            <div class="header-left">
                <h1>ðŸŽ® Game Data Editor</h1>
                <span class="version">v2.0.0</span>
                <div class="current-project">
                    <span class="current-project-label">Project:</span>
                    <span id="current-project-name" class="current-project-name">Untitled Project</span>
                </div>
            </div>
            <div class="header-right">
                <div class="dropdown">
                    <button id="menu-btn" class="btn btn-secondary" title="Menu">
                        â˜°
                    </button>
                    <div id="menu-dropdown" class="dropdown-menu">
                        <button id="projects-btn" class="dropdown-item">
                            Projects
                        </button>
                        <button id="new-project-btn" class="dropdown-item">
                            New Project
                        </button>
                        <div class="dropdown-divider"></div>
                        <button id="import-btn" class="dropdown-item">
                            Import File
                        </button>
                        <button id="export-btn" class="dropdown-item">
                            Export File
                        </button>
                    </div>
                </div>
                <button id="toggle-flows-btn" class="btn btn-secondary" title="Toggle Flows Visualizer">
                    Flows
                </button>
                <button id="toggle-composer-btn" class="btn btn-secondary" title="Toggle Visual Scene Composer">
                    Composer
                </button>
                <button id="toggle-code-btn" class="btn btn-secondary" title="Toggle Code View">
                    Code
                </button>
                <button id="save-project-btn" class="btn btn-primary">
                    Save Project
                </button>
            </div>
        </header>

        <!-- Main Layout -->
        <div class="editor-main">
            <!-- Left Sidebar - Navigation -->
            <aside class="editor-sidebar">
                <nav class="editor-nav">
                    <button class="nav-tab active" data-tab="scenes">
                        Scenes
                    </button>
                    <button class="nav-tab" data-tab="items">
                        Items
                    </button>
                    <button class="nav-tab" data-tab="audio">
                        Audio
                    </button>
                </nav>

                <!-- Scenes List -->
                <div class="tab-content active" id="scenes-list">
                    <div class="list-header">
                        <h3>Scenes</h3>
                        <button id="add-scene-btn" class="btn-icon" title="Add Scene">âž•</button>
                    </div>
                    <div class="search-box">
                        <input type="text" id="scene-search" placeholder="Search scenes...">
                    </div>
                    <ul id="scenes-list-items" class="item-list">
                        <!-- Populated by JS -->
                    </ul>
                </div>

                <!-- Items List -->
                <div class="tab-content" id="items-list">
                    <div class="list-header">
                        <h3>Items</h3>
                        <button id="add-item-btn" class="btn-icon" title="Add Item">âž•</button>
                    </div>
                    <div class="search-box">
                        <input type="text" id="item-search" placeholder="Search items...">
                    </div>
                    <div class="filter-group">
                        <label>Filter by type:</label>
                        <select id="item-type-filter">
                            <option value="">All Types</option>
                            <option value="item">Item</option>
                            <option value="target">Target</option>
                            <option value="link">Link</option>
                            <option value="decor">Decor</option>
                        </select>
                    </div>
                    <ul id="items-list-items" class="item-list">
                        <!-- Populated by JS -->
                    </ul>
                </div>

                <!-- Audio List -->
                <div class="tab-content" id="audio-list">
                    <div class="list-header">
                        <h3>Audio</h3>
                    </div>
                    <div class="audio-info">
                        <p style="font-size: 0.9em; color: var(--text-muted); padding: var(--spacing-md);">
                            Configure ambient music and sound effects for your game.
                        </p>
                    </div>
                </div>
            </aside>

            <!-- Main Content Area -->
            <main class="editor-content">
                <!-- Welcome Screen -->
                <div id="welcome-screen" class="welcome-screen active">
                    <div class="welcome-content">
                        <h2>Welcome to the Game Data Editor</h2>
                        <p>Get started by:</p>
                        <ul>
                            <li>Importing your existing <code>gameData.js</code> file</li>
                            <li>Creating a new scene</li>
                            <li>Adding new items</li>
                        </ul>
                        <div class="welcome-actions">
                            <button id="welcome-import-btn" class="btn btn-primary btn-large">
                                Import Existing Data
                            </button>
                            <button id="welcome-new-btn" class="btn btn-secondary btn-large">
                                Start Fresh
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Scene Editor -->
                <div id="scene-editor" class="editor-panel">
                    <div class="panel-header">
                        <h2 id="scene-editor-title">Edit Scene</h2>
                        <div class="panel-actions">
                            <button id="delete-scene-btn" class="btn btn-danger">Delete</button>
                            <button id="duplicate-scene-btn" class="btn btn-secondary">Duplicate</button>
                        </div>
                    </div>
                    <form id="scene-form" class="editor-form">
                        <!-- Scene form fields will be populated by JS -->
                    </form>
                </div>

                <!-- Item Editor -->
                <div id="item-editor" class="editor-panel">
                    <div class="panel-header">
                        <h2 id="item-editor-title">Edit Item</h2>
                        <div class="panel-actions">
                            <button id="delete-item-btn" class="btn btn-danger">Delete</button>
                            <button id="duplicate-item-btn" class="btn btn-secondary">Duplicate</button>
                        </div>
                    </div>
                    <form id="item-form" class="editor-form">
                        <!-- Item form fields will be populated by JS -->
                    </form>
                </div>

                <!-- Code Editor -->
                <div id="code-editor" class="editor-panel">
                    <div class="panel-header">
                        <h2>ðŸ’» Code Editor</h2>
                        <div class="panel-actions">
                            <button id="format-code-btn" class="btn btn-sm btn-secondary" title="Format Code">
                                Format
                            </button>
                            <button id="revert-code-btn" class="btn btn-sm btn-secondary" title="Revert Changes">
                                Revert
                            </button>
                            <button id="apply-code-btn" class="btn btn-sm btn-primary" title="Apply Changes">
                                Apply Changes
                            </button>
                        </div>
                    </div>
                    <div id="code-status" class="code-status">
                        Code is in sync with editor
                    </div>
                    <div id="code-error" class="code-error" style="display: none;">
                        <!-- Error messages -->
                    </div>
                    <div class="code-editor-container">
                        <div id="line-numbers" class="line-numbers"></div>
                        <textarea id="code-textarea" class="code-textarea" spellcheck="false"></textarea>
                    </div>
                </div>

                <!-- Audio Editor -->
                <div id="audio-editor" class="editor-panel">
                    <div class="panel-header">
                        <h2>Audio Configuration</h2>
                    </div>
                    <form id="audio-form" class="editor-form">
                        <!-- Audio form fields will be populated by JS -->
                    </form>
                </div>

                <!-- Flows Visualizer -->
                <div id="flows-container" class="flows-container">
                    <div class="flows-header">
                        <h2>ðŸ“Š Flows Visualizer</h2>
                        <nav class="flows-tabs">
                            <button class="flows-tab active" data-flows-tab="flowchart">
                                Flows
                            </button>
                            <button class="flows-tab" data-flows-tab="graph">
                                Graph
                            </button>
                            <button class="flows-tab" data-flows-tab="tree">
                                Tree
                            </button>
                        </nav>
                    </div>
                    <div class="flows-content">
                        <!-- Flowchart Tab -->
                        <div id="flowchart-view" class="flows-view active">
                            <div class="flows-view-header">
                                <h3>Scene Flow Chart</h3>
                                <p class="flows-description">Visual representation of scene connections and navigation paths</p>
                                <div class="flows-legend">
                                    <span class="legend-item"><span class="legend-box" style="background: #4a9eff;"></span> Scene</span>
                                    <span class="legend-item"><span class="legend-box" style="background: #f9f;"></span> Puzzle</span>
                                    <span class="legend-item"><span class="legend-line"></span> Sequential</span>
                                    <span class="legend-item"><span class="legend-line legend-dashed"></span> Link</span>
                                </div>
                            </div>
                            <div id="flowchart-canvas" class="flows-canvas">
                                <!-- Flowchart will be rendered here -->
                            </div>
                        </div>

                        <!-- Graph Tab -->
                        <div id="graph-view" class="flows-view">
                            <div class="flows-view-header">
                                <h3>Item Dependency Graph</h3>
                                <p class="flows-description">Shows relationships between items (useWith, combineWith, results)</p>
                                <div class="flows-legend">
                                    <span class="legend-item"><span class="legend-box" style="background: #ffd700;"></span> Item</span>
                                    <span class="legend-item"><span class="legend-box" style="background: #ff69b4;"></span> Target</span>
                                    <span class="legend-item"><span class="legend-box" style="background: #20b2aa;"></span> Link</span>
                                    <span class="legend-item"><span class="legend-line" style="background: #4a9eff;"></span> Use</span>
                                    <span class="legend-item"><span class="legend-line legend-dashed" style="background: #ff9800;"></span> Combine</span>
                                    <span class="legend-item"><span class="legend-line legend-thick" style="background: #4caf50;"></span> Creates</span>
                                </div>
                            </div>
                            <div id="graph-canvas" class="flows-canvas">
                                <!-- Graph will be rendered here -->
                            </div>
                        </div>

                        <!-- Tree Tab -->
                        <div id="tree-view" class="flows-view">
                            <div class="flows-view-header">
                                <h3>Scene Tree Map</h3>
                                <p class="flows-description">Hierarchical view of scenes and their items</p>
                            </div>
                            <div id="tree-canvas" class="flows-canvas">
                                <!-- Tree will be rendered here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Visual Scene Composer -->
                <div id="composer-container" class="composer-container">
                    <div class="composer-header">
                        <div class="composer-title">
                            <h2>Visual Scene Composer</h2>
                            <span id="composer-scene-name" class="composer-scene-name">No scene selected</span>
                        </div>
                        <div class="composer-controls">
                            <button id="composer-zoom-out" class="btn btn-sm btn-secondary" title="Zoom Out">
                                âˆ’
                            </button>
                            <span id="composer-zoom-level" class="composer-zoom-level">100%</span>
                            <button id="composer-zoom-in" class="btn btn-sm btn-secondary" title="Zoom In">
                                +
                            </button>
                            <button id="composer-fit" class="btn btn-sm btn-secondary" title="Fit to View">
                                â›¶ Fit
                            </button>
                            <button id="composer-grid-toggle" class="btn btn-sm btn-secondary" title="Toggle Grid">
                                âŠž Grid
                            </button>
                            <button id="composer-hitarea-toggle" class="btn btn-sm btn-secondary" title="Toggle Hit Area Visualization">
                                â—Ž Hit Areas
                            </button>
                        </div>
                    </div>
                    <div class="composer-workspace">
                        <div class="composer-canvas-wrapper">
                            <canvas id="composer-canvas" class="composer-canvas"></canvas>
                            <div id="composer-items-layer" class="composer-items-layer">
                                <!-- Items will be rendered here -->
                            </div>
                        </div>
                    </div>
                </div>
            </main>

            <!-- Right Sidebar - Properties/Settings/Assets -->
            <aside class="editor-preview">
                <nav class="preview-nav">
                    <button class="preview-tab active" data-preview-tab="properties">
                        Properties
                    </button>
                    <button class="preview-tab" data-preview-tab="settings">
                        Settings
                    </button>
                    <button class="preview-tab" data-preview-tab="assets">
                        Assets
                    </button>
                </nav>

                <!-- Properties Tab -->
                <div class="preview-tab-content active" id="properties-content">
                    <div class="properties-panel">
                        <div class="properties-header">
                            <h3>Item Properties</h3>
                        </div>
                        <div id="properties-form-container" class="properties-form-container">
                            <div class="properties-empty-state">
                                <p>Select an item in the composer to edit its properties</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Tab -->
                <div class="preview-tab-content" id="settings-tab-content">
                    <div class="settings-tab-header">
                        <h3>Game Settings</h3>
                    </div>
                    <form id="settings-form" class="editor-form">
                        <!-- Settings form fields will be populated by JS -->
                    </form>
                </div>

                <!-- Assets Tab -->
                <div class="preview-tab-content" id="assets-tab-content">
                    <div class="assets-tab-header">
                        <h3>Project Assets</h3>
                        <button id="refresh-assets-btn" class="btn btn-secondary btn-sm">
                            Refresh
                        </button>
                    </div>
                    <div id="assets-container" class="assets-container">
                        <p class="loading-message">Loading assets...</p>
                    </div>
                </div>
            </aside>
        </div>

        <!-- Status Bar -->
        <footer class="editor-footer">
            <div class="status-left">
                <span id="status-message">Ready</span>
            </div>
            <div class="status-right">
                <span id="item-count">0 items</span>
                <span class="separator">|</span>
                <span id="scene-count">0 scenes</span>
            </div>
        </footer>
    </div>

    <!-- Hidden file input for import -->
    <input type="file" id="file-input" accept=".js" style="display: none;">

    <!-- Modal for confirmations and projects -->
    <div id="modal" class="modal-overlay" style="display: none;">
        <div class="modal" style="max-width: 700px;">
            <div class="modal-header">
                <h3 id="modal-title">Confirm</h3>
                <button id="modal-close" class="btn-icon" onclick="document.getElementById('modal').style.display='none'">âœ•</button>
            </div>
            <div class="modal-body" id="modal-body">
                <p id="modal-message"></p>
            </div>
            <div class="modal-footer" id="modal-actions">
                <button id="modal-cancel" class="btn btn-secondary" onclick="document.getElementById('modal').style.display='none'">Cancel</button>
                <button id="modal-confirm" class="btn btn-primary">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Auto-save indicator -->
    <div id="autosave-indicator">âœ“ Auto-saved</div>

    <!-- Scripts -->
    <script type="module" src="js/editor.js"></script>
</body>
</html>

